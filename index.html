<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Aplicações Real Time com Drupal e NodeJS</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="node_modules/reveal.js/css/reveal.min.css">
		<link rel="stylesheet" href="node_modules/reveal.js/css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="node_modules/reveal.js/lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'node_modules/reveal.js/css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h2>Guilherme Lopes</h2>
					<p> Desenvolvedor Drupal </p>
					<ul>
						<li>Github: guiajlopes</li>
						<li class="drupal">Drupal.org: guilopes</li>
						<li class="mail">Email: guilherme@mmda.com.br</li>
					</ul>
					<aside class="notes">
				        Bom dia pessoal, meu nome é Guilherme Lopes. Sou desenvolvedor Drupal há 3 anos mais focado em desenvolvimento Back-end. Atualmente estou trabalhando na MMDA. Coloquei alguns lugares aonde vocês podem me encontrar. Guiajlopes no github, no drupal.org guilopes. Qualquer sugestão dúvidas e feedbacks vocês podem enviar para guilherme@mmda.com.br
				    </aside>
				</section>

				<section>
					<h2>Aplicações Real Time com Drupal e Node.js</h2>
					<aside class="notes">
						Hoje vou falar sobre aplicações real time com Drupal e Nodejs
					</aside>
				</section>

				<section>
					<h1>O que é Node.js?</h1>
					<aside class="notes">
						Quem sabe o que é nodejs?
						<br>
						E quem já trabalhou com nodejs?
					</aside>
				</section>

				<section class="fragments">
				<h2>Node.js</h2>
					<ul>
						<li class="fragment">Javascript Server Side</li>
						<li class="fragment">Baseado na engine V8 do Google</li>
						<li class="fragment">Orientado a Eventos</li>
						<li class="fragment">Assíncrono</li>
						<li class="fragment">Sistema modular</li>
					</ul>
					<aside class="notes">
						- V8 é um engine da google, usada no google Crhoem apra interpretar o javascript do navegador. V8 é construido em C++.
					</aside>
				</section>

				<section>
				  <h2>Node.js</h2>
				  <p>Exemplo de um servidor Nodejs</p>
					<pre>
						<code class="hljs javascript">
						var http = require('http');
						http.createServer(function(req,res) {
						  var head = { 'Content-Type': 'text/plain; charset=utf-8' };
						  res.writeHead(200, head);
						  res.end('Olá mundo!');
						}).listen(3000);
						console.log('Servidor iniciado em localhost:3000.');
						</code>
					</pre>
				</section>

				<section>
					<h2>Node.js - Gerenciador de pacotes</h2>
					<p> O Gerenciador de pacotes do nodejs é o NPM.</p>
					<aside class="notes">
						Já existem muitos modulos de node nesse repositorios. Módulos de rotas como o express, modulos de testes funcionais, unitários e assim por diante.
					</aside>
				</section>

				<section class="fragments">
					<h2>Em que casos usar Node.js?</h2>
					<ul>
						<li class="fragment">Automatização de Tarefas</li>
						<li class="fragment">Restfull API</li>
						<li class="fragment">Aplicações Real Time</li>
					</ul>
				</section>
				<section>
					<h2>Cases de NodeJS</h2>
					<p>Grandes empresas como Linkedin, Wallmart, Grupon, Microsoft e Paypal usam NodeJS</p>
				</section>

				<section>
					<h2> WebSocket </h2>
					<p> É uma tecnologia que permite comunicação bidirecional de baixa latência </p>


				</section>

				<section class="fragments">
					<h2> Módulo Socket.IO </h2>
					<ul>
						<li class="fragment">Utilizado para interação Real Time</li>
						<li class="fragment">Utiliza Websocket</li>
						<li class="fragment">Crossbrowser (IE6+)</li>
					</ul>
				</section>

				<section>
					<h2> Principais funções do Socket.IO : </h2>
					<pre>
						<code class="hljs javascript">
							// Evento quando o usuário se conecta.
							io.on('connection', function(client) {

							});

							// Servidor enviando mensagem para client.
							client.emit("seu-evento", data);

							// Envia mensagem para os demais clientes.
							client.broadcast.emit("seu-evento", data)
						</code>
					</pre>
				</section>

				<section>
					<h2> Principais funções do Socket.IO : </h2>
					<pre>
						<code class="hljs javascript">
							// Evento disparado quando usuário desconecta.
							client.on("disconnect", function() {

							});

							// Evento que o servidor escuta uma ação do cliente.
							client.on("um-evento", function(data) {

							});
						</code>
					</pre>
				</section>

				<section>
					<h2> Drupal e Node.js </h2>
					<p> Nodejs Integration : https://www.drupal.org/project/nodejs </p>
					<p> Views Nodejs : https://www.drupal.org/project/views_nodejs </p>
				</section>

				<section class="fragments">
					<h2>Sobre o módulo Node.js Integration</h2>
					<ul>
						<li class="fragment">Utiliza socket.io</li>
						<li class="fragment">User channels</li>
						<li class="fragment">Content channels</li>
						<li class="fragment">PHP API</li>
						<li class="fragment">Possibilita extender o server</li>
					</ul>
				</section>

				<section>
					<section>
						<h2> Autenticação </h2>
						<p>Primeira Autenticação</p>
						<img src="img/diagrama_nodejs_primeira_conexao.png">
					</section>
					<section>
						<h2>Autenticação</h2>
						<p>Demais Autenticações</p>
						<img src="img/diagrama_nodejs.png">
					</section>
				</section>
				<section>
					<section>
						<h2> Node.js Integration API </h2>
						<p> Criando um user channel </p>
						<pre>
							<code class="hlphp php">
									/**
									 * Implements hook_nodejs_user_channels().
									 */
									function hook_nodejs_user_channels($account) {
									  if ($account->uid > 0) {
									    return array('nodejs_user_' . $account->uid);
									  }
									}
							</code>
						</pre>
					</section>
					<section>
						<h2> Node.js Integration API </h2>
						<p>Enviando uma mensagem</p>
						<pre>
							<code class="hlphp php">
							  // Build message object.
							  $message = new stdClass();
							  $message->channel = 'meu_channel';
							  $message->callback = 'meu_callback'
							  $message->data = (object) array(
							    'body' => 'Sua mensagem',
							  );

							  nodejs_enqueue_message($message);
							</code>
						</pre>
					</section>
					<section>
						<h2> Node.js Integration API </h2>
						<p>Callback da mensagem no Javascript.</p>
						<pre>
							<code class="hljs js">
								(function ($) {
								  /**
								   * Drupal.Nodejs.callback
								   */
								  Drupal.Nodejs.callbacks.meu_callback = {
								    callback: function (message) {
								      if (message.channel == 'meu_channel') {
								        // Realiza uma ação.
								      }
								    }
								  };
								}(jQuery));
							</code>
						</pre>
					</section>
				</section>

				<section>
					<h1>Na Prática...</h1>
				</section>
		  	<section>
					<h1> Perguntas? </h1>
				</section>

			</div>

		</div>

		<script src="node_modules/reveal.js/lib/js/head.min.js"></script>
		<script src="node_modules/reveal.js/js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'node_modules/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'node_modules/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'node_modules/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'node_modules/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'node_modules/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'node_modules/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
